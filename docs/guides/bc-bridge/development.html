<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BC Bridge Development Guide</title>
    <meta name="description" content="Development workflow and best practices for BC Bridge plugin">
    <!-- frontmatter
title: "BC Bridge Development Guide"
description: "Development workflow and best practices for BC Bridge plugin"
category: "guides"
order: 1
-->
</head>
<body>

<h1>BC Bridge Development Guide</h1>

<p>This guide covers the development workflow, coding standards, and best practices for working with the BC Bridge plugin.</p>

<h2>Development Setup</h2>

<h3>Prerequisites</h3>

<ul>
<li>WordPress development environment (local or remote)</li>
<li>Node.js and npm (for build tools)</li>
<li>Composer (for PHP dependencies)</li>
<li>BigCommerce store with API credentials</li>
</ul>

<h3>Local Development</h3>

<pre><code class="language-bash"># Clone repository
git clone https://github.com/bigcommerce/bc-bridge.git
cd bc-bridge

# Install dependencies
make install

# Create symlink to WordPress plugins directory
WP_PLUGINS_DIR=/path/to/wp-content/plugins make deploy-link

# Watch for changes (auto-rebuild)
make watch
</code></pre>

<h3>File Structure</h3>

<pre><code>bc-bridge/
├── admin/              # Admin interface classes
├── assets/             # Frontend assets (CSS, JS)
│   ├── css/           # Stylesheets
│   └── js/            # JavaScript files
├── includes/          # Core plugin classes
├── templates/         # PHP templates
├── languages/         # Translation files
├── tests/             # Unit and integration tests
├── build/             # Build output (gitignored)
└── bc-bridge.php      # Main plugin file
</code></pre>

<h2>Coding Standards</h2>

<h3>PHP Standards</h3>

<ul>
<li>Follow WordPress Coding Standards</li>
<li>Use PSR-12 for class structure</li>
<li>Type hints for all parameters and return types (PHP 8.1+)</li>
<li>Document all public methods with PHPDoc</li>
</ul>

<h3>JavaScript Standards</h3>

<ul>
<li>ES6+ syntax</li>
<li>No jQuery dependencies (use vanilla JS or modern frameworks)</li>
<li>Follow WordPress JavaScript Coding Standards</li>
</ul>

<h3>CSS Standards</h3>

<ul>
<li>Use CSS variables for theming</li>
<li>Follow BEM naming convention</li>
<li>Mobile-first responsive design</li>
</ul>

<h2>API Client Development</h2>

<h3>Making API Requests</h3>

<p>The <code>BC_Bridge_API_Client</code> class handles all BigCommerce API communication:</p>

<pre><code class="language-php">// Get API client instance
$api = bc_bridge()->api;

// Make GET request
$response = $api->request('GET', '/catalog/products', [], [
    'limit' => 12,
    'page' => 1,
]);

// Make POST request
$response = $api->request('POST', '/carts', [
    'line_items' => [
        ['product_id' => 123, 'quantity' => 1],
    ],
]);
</code></pre>

<h3>Rate Limiting</h3>

<p>The API client automatically handles rate limiting:</p>

<ul>
<li>Tracks rate limit headers from responses</li>
<li>Returns <code>WP_Error</code> when rate limited</li>
<li>Respects rate limit reset times</li>
</ul>

<h3>Error Handling</h3>

<pre><code class="language-php">$response = $api->get_product(123);

if (is_wp_error($response)) {
    $error_code = $response->get_error_code();
    $error_message = $response->get_error_message();
    
    // Handle error
    error_log("API Error: {$error_code} - {$error_message}");
}
</code></pre>

<h2>Cache Development</h2>

<h3>Cache Groups</h3>

<p>BC Bridge uses cache groups for organized caching:</p>

<ul>
<li><code>products</code> - Product data</li>
<li><code>categories</code> - Category data</li>
<li><code>cart</code> - Cart data</li>
<li><code>store</code> - Store information</li>
</ul>

<h3>Using Cache</h3>

<pre><code class="language-php">// Get from cache
$cached = BC_Bridge_Cache::get('product_123', 'products');
if ($cached !== false) {
    return $cached;
}

// Fetch from API
$product = $api->get_product(123);

// Store in cache (1 hour)
BC_Bridge_Cache::set('product_123', $product, 'products', HOUR_IN_SECONDS);
</code></pre>

<h3>Cache Invalidation</h3>

<pre><code class="language-php">// Clear all cache
BC_Bridge_Cache::clear_all();

// Clear specific group
BC_Bridge_Cache::clear_group('products');

// Clear specific key
BC_Bridge_Cache::delete('product_123', 'products');
</code></pre>

<h2>Template Development</h2>

<h3>Template Hierarchy</h3>

<p>BC Bridge follows WordPress template hierarchy:</p>

<ol>
<li>Theme override: <code>your-theme/bc-bridge/shop.php</code></li>
<li>Plugin default: <code>bc-bridge/templates/shop.php</code></li>
</ol>

<h3>Template Functions</h3>

<pre><code class="language-php">// Get current product
$product = bc_bridge_get_product();

// Get current category
$category = bc_bridge_get_category();

// Get cart
$cart = bc_bridge()->cart->get_cart();

// Get checkout URL
$checkout_url = bc_bridge()->cart->get_checkout_url();
</code></pre>

<h3>Template Hooks</h3>

<pre><code class="language-php">// Before product content
do_action('bc_bridge_before_product_content', $product);

// After product content
do_action('bc_bridge_after_product_content', $product);

// Before product grid
do_action('bc_bridge_before_product_grid', $products);

// After product grid
do_action('bc_bridge_after_product_grid', $products);
</code></pre>

<h2>Testing</h2>

<h3>Unit Tests</h3>

<pre><code class="language-bash"># Run unit tests
make test

# Run specific test file
vendor/bin/phpunit tests/unit/class-bc-bridge-api-client-test.php
</code></pre>

<h3>Integration Tests</h3>

<pre><code class="language-bash"># Run integration tests (requires WordPress test environment)
make test-integration
</code></pre>

<h3>Manual Testing</h3>

<ul>
<li>Test product display on shop page</li>
<li>Test single product page</li>
<li>Test category pages</li>
<li>Test cart functionality</li>
<li>Test checkout flow</li>
<li>Test API error handling</li>
<li>Test cache behavior</li>
</ul>

<h2>Debugging</h2>

<h3>Enable Debug Mode</h3>

<pre><code class="language-php">// In wp-config.php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('BC_BRIDGE_DEBUG', true);
</code></pre>

<h3>Logging</h3>

<pre><code class="language-php">// Log API requests
BC_Bridge_API_Client::log_error('API request failed', [
    'endpoint' => '/catalog/products',
    'error' => $error_message,
]);

// Check logs
tail -f wp-content/debug.log
</code></pre>

<h3>Common Issues</h3>

<ul>
<li><strong>API Errors:</strong> Check credentials and API scopes</li>
<li><strong>Rate Limiting:</strong> Increase cache duration or reduce API calls</li>
<li><strong>Template Not Loading:</strong> Flush rewrite rules</li>
<li><strong>Cart Not Working:</strong> Check cookie settings and SSL</li>
</ul>

<h2>Build Process</h2>

<h3>Development Build</h3>

<pre><code class="language-bash"># Watch for changes and auto-rebuild
make watch
</code></pre>

<h3>Production Build</h3>

<pre><code class="language-bash"># Build optimized assets
make build

# Create distribution ZIP
make zip
</code></pre>

<h3>Version Management</h3>

<pre><code class="language-bash"># Bump version (updates all version references)
make version NEW_VERSION=1.1.0
</code></pre>

<h2>Best Practices</h2>

<h3>API Usage</h3>

<ul>
<li>Always use caching to reduce API calls</li>
<li>Handle rate limits gracefully</li>
<li>Implement retry logic for transient errors</li>
<li>Log errors for debugging</li>
</ul>

<h3>Performance</h3>

<ul>
<li>Cache API responses appropriately</li>
<li>Use lazy loading for product images</li>
<li>Minimize JavaScript and CSS</li>
<li>Optimize database queries</li>
</ul>

<h3>Security</h3>

<ul>
<li>Sanitize all user input</li>
<li>Escape all output</li>
<li>Use nonces for AJAX requests</li>
<li>Validate API credentials</li>
</ul>

<h2>Related Documentation</h2>

<ul>
<li><a href="customization.html">Customization Guide</a></li>
<li><a href="../reference/bc-bridge/hooks.html">Hooks Reference</a></li>
<li><a href="../reference/bc-bridge/templates.html">Templates Guide</a></li>
<li><a href="../reference/bc-bridge/shortcodes.html">Shortcodes Reference</a></li>
</ul>

</body>
</html>

